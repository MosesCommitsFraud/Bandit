<Window x:Class="Bandit.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Bandit" Height="750" Width="1200"
        AllowDrop="True"
        Drop="Window_Drop"
        DragOver="Window_DragOver"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="CanResizeWithGrip"
        Background="Transparent"
        Icon="Assets/logo-white.png">
  <Border BorderBrush="{StaticResource BorderColor}" 
          BorderThickness="1" 
          CornerRadius="12"
          Background="{StaticResource BackgroundDark}">
    <DockPanel ClipToBounds="False">
      <!-- Custom Title Bar -->
      <Border DockPanel.Dock="Top" 
              Background="{StaticResource BackgroundMedium}"
              CornerRadius="12,12,0,0"
              MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
        <Grid Height="40">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
          </Grid.ColumnDefinitions>
          <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="12,0">
            <Image Source="Assets/logo-white.png" 
                   Width="24" 
                   Height="24" 
                   Margin="0,0,8,0"
                   RenderOptions.BitmapScalingMode="HighQuality"/>
            <TextBlock Text="Bandit" 
                       VerticalAlignment="Center"
                       FontSize="16"
                       FontWeight="SemiBold"
                       Foreground="{StaticResource TextPrimary}"/>
          </StackPanel>
          <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,8,0">
            <!-- Minimize Button -->
            <Border Width="32" 
                    Height="32"
                    Margin="4"
                    CornerRadius="6"
                    Background="Transparent"
                    Cursor="Hand"
                    MouseLeftButtonDown="Minimize_Click">
              <Border.Style>
                <Style TargetType="Border">
                  <Setter Property="Background" Value="Transparent"/>
                  <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                      <Setter Property="Background" Value="{StaticResource BackgroundLight}"/>
                    </Trigger>
                  </Style.Triggers>
                </Style>
              </Border.Style>
              <Path Data="M 8,16 L 24,16" 
                    Stroke="{StaticResource TextSecondary}" 
                    StrokeThickness="2"
                    Stretch="Uniform"
                    Width="16"
                    Height="16"/>
            </Border>
            
            <!-- Maximize Button -->
            <Border Width="32" 
                    Height="32"
                    Margin="4"
                    CornerRadius="6"
                    Background="Transparent"
                    Cursor="Hand"
                    MouseLeftButtonDown="Maximize_Click">
              <Border.Style>
                <Style TargetType="Border">
                  <Setter Property="Background" Value="Transparent"/>
                  <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                      <Setter Property="Background" Value="{StaticResource BackgroundLight}"/>
                    </Trigger>
                  </Style.Triggers>
                </Style>
              </Border.Style>
              <Path Data="M 8,8 L 24,8 L 24,24 L 8,24 Z" 
                    Stroke="{StaticResource TextSecondary}" 
                    StrokeThickness="2"
                    Fill="Transparent"
                    Stretch="Uniform"
                    Width="14"
                    Height="14"/>
            </Border>
            
            <!-- Close Button -->
            <Border Width="32" 
                    Height="32"
                    Margin="4"
                    CornerRadius="6"
                    Background="Transparent"
                    Cursor="Hand"
                    MouseLeftButtonDown="Exit_Click">
              <Border.Style>
                <Style TargetType="Border">
                  <Setter Property="Background" Value="Transparent"/>
                  <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                      <Setter Property="Background" Value="{StaticResource AccentDanger}"/>
                    </Trigger>
                  </Style.Triggers>
                </Style>
              </Border.Style>
              <Path x:Name="closePath"
                    Data="M 10,10 L 22,22 M 22,10 L 10,22" 
                    Stroke="{StaticResource TextSecondary}" 
                    StrokeThickness="2"
                    Stretch="Uniform"
                    Width="14"
                    Height="14">
                <Path.Style>
                  <Style TargetType="Path">
                    <Style.Triggers>
                      <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=Border}}" Value="True">
                        <Setter Property="Stroke" Value="{StaticResource TextPrimary}"/>
                      </DataTrigger>
                    </Style.Triggers>
                  </Style>
                </Path.Style>
              </Path>
            </Border>
          </StackPanel>
        </Grid>
      </Border>

      <!-- Menu Bar -->
      <Menu DockPanel.Dock="Top" Padding="8,4">
        <MenuItem Header="File" StaysOpenOnClick="True">
          <MenuItem Header="Open Downloads Folder" Command="{Binding OpenFolderCommand}"/>
          <Separator/>
          <MenuItem Header="Exit" Click="Exit_Click"/>
        </MenuItem>
        <MenuItem Header="Edit" StaysOpenOnClick="True">
          <MenuItem Header="Add Sound..." Command="{Binding AddSoundCommand}"/>
          <MenuItem Header="Clear All Sounds" Command="{Binding ClearAllCommand}"/>
        </MenuItem>
        <MenuItem Header="View" StaysOpenOnClick="True">
          <MenuItem Header="Refresh Sounds" Command="{Binding RefreshCommand}" ToolTip="Reload all sounds from folder"/>
        </MenuItem>
        <MenuItem Header="Help" StaysOpenOnClick="True">
          <MenuItem Header="About" Click="About_Click"/>
        </MenuItem>
      </Menu>

      <!-- Main Content -->
      <Grid Margin="20" ClipToBounds="False">
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Download Section -->
        <Border Background="{StaticResource BackgroundMedium}"
                BorderBrush="{StaticResource BorderColor}"
                BorderThickness="1"
                CornerRadius="12"
                Padding="12"
                Margin="0,0,0,12">
          <StackPanel>
            <TextBlock Text="Download from YouTube" 
                       FontSize="14" 
                       FontWeight="SemiBold" 
                       Margin="0,0,0,8"
                       Foreground="{StaticResource TextPrimary}"/>
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
              </Grid.ColumnDefinitions>
              <TextBox Text="{Binding Url, UpdateSourceTrigger=PropertyChanged}" 
                       ToolTip="Enter YouTube URL (audio will be extracted automatically) or drag audio files into the window"
                       Height="32"
                       Cursor="IBeam"
                       VerticalContentAlignment="Center"
                       Padding="8,4"/>
              <Button Content="Download Audio" 
                      Command="{Binding DownloadCommand}" 
                      Grid.Column="1"
                      Margin="8,0,0,0"
                      Padding="16,6"
                      Height="32"/>
            </Grid>
          </StackPanel>
        </Border>

        <!-- Toolbar Section -->
        <Border Grid.Row="1"
                Background="{StaticResource BackgroundMedium}"
                BorderBrush="{StaticResource BorderColor}"
                BorderThickness="1"
                CornerRadius="12"
                Padding="10"
                Margin="0,0,0,12">
          <Grid>
            <StackPanel Orientation="Horizontal">
              <Button Content="➕ Add Sound" 
                      Command="{Binding AddSoundCommand}" 
                      Padding="12,6"
                      Style="{StaticResource SecondaryButton}"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
              <TextBlock VerticalAlignment="Center">
                <Run Text="Total Sounds:" Foreground="{StaticResource TextSecondary}"/>
                <Run Text="{Binding Sounds.Count, Mode=OneWay}" 
                     FontWeight="Bold" 
                     FontSize="14"
                     Foreground="{StaticResource AccentPrimary}"/>
              </TextBlock>
            </StackPanel>
          </Grid>
        </Border>

        <!-- Sounds Grid - Card Layout like sketch -->
        <ScrollViewer Grid.Row="2" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Background="Transparent"
                      ClipToBounds="False"
                      Padding="10">
          <ItemsControl ItemsSource="{Binding Sounds}" ClipToBounds="False">
            <ItemsControl.ItemsPanel>
              <ItemsPanelTemplate>
                <WrapPanel Orientation="Horizontal" ClipToBounds="False"/>
              </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
              <DataTemplate>
                <Border Background="{StaticResource CardBackground}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        CornerRadius="12"
                        Padding="0"
                        Margin="16"
                        Width="280"
                        Height="260">
                  <Border.Effect>
                    <DropShadowEffect Color="Black" Opacity="0.4" BlurRadius="12" ShadowDepth="4"/>
                  </Border.Effect>
                  <Border.Style>
                    <Style TargetType="Border">
                      <Setter Property="BorderThickness" Value="1"/>
                      <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                          <Setter Property="BorderBrush" Value="{StaticResource AccentPrimary}"/>
                          <Setter Property="BorderThickness" Value="2"/>
                          <Setter Property="Background" Value="{StaticResource BackgroundMedium}"/>
                          <Setter Property="Effect">
                            <Setter.Value>
                              <DropShadowEffect Color="#A78BFA" Opacity="0.95" BlurRadius="30" ShadowDepth="0" RenderingBias="Quality"/>
                            </Setter.Value>
                          </Setter>
                        </Trigger>
                      </Style.Triggers>
                    </Style>
                  </Border.Style>
                  <Grid>
                    <Grid.RowDefinitions>
                      <RowDefinition Height="140"/>
                      <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Image/Thumbnail Area -->
                    <Border Background="{StaticResource BackgroundLight}"
                            CornerRadius="12,12,0,0">
                      <Viewbox Width="80" Height="80">
                        <TextBlock Text="🎵" 
                                   FontSize="64"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Foreground="{StaticResource AccentSecondary}"/>
                      </Viewbox>
                    </Border>
                    
                    <!-- Info Area -->
                    <StackPanel Grid.Row="1" Margin="16,12,16,12">
                      <TextBlock Text="{Binding DisplayName}" 
                                 FontWeight="SemiBold" 
                                 FontSize="15"
                                 TextTrimming="CharacterEllipsis" 
                                 ToolTip="{Binding DisplayName}"
                                 Foreground="{StaticResource TextPrimary}"
                                 Margin="0,0,0,4"/>
                      <TextBlock Text="{Binding HotkeyLabel}" 
                                 Foreground="{StaticResource TextSecondary}"
                                 FontSize="11" 
                                 Margin="0,0,0,10"/>
                      <Grid>
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition Width="*"/>
                          <ColumnDefinition Width="Auto"/>
                          <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Button Content="▶" 
                                Command="{Binding PlayCommand}" 
                                Padding="8,6"
                                FontWeight="SemiBold"
                                FontSize="12"
                                Width="36"
                                Height="32"
                                HorizontalAlignment="Left"/>
                        <Button Content="⌨" 
                                Command="{Binding BindCommand}" 
                                Grid.Column="1"
                                Padding="8,6"
                                FontSize="12"
                                Width="36"
                                Height="32"
                                Margin="4,0,0,0"
                                Style="{StaticResource SecondaryButton}"/>
                        <Button Content="🗑" 
                                Command="{Binding RemoveCommand}" 
                                Grid.Column="2"
                                Padding="8,6"
                                FontSize="12"
                                Width="36"
                                Height="32"
                                Margin="4,0,0,0"
                                Style="{StaticResource DangerButton}"/>
                      </Grid>
                    </StackPanel>
                  </Grid>
                </Border>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>
        </ScrollViewer>
      </Grid>
    </DockPanel>
  </Border>
</Window>
