<Window x:Class="GnR.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="GnR - Grab and Run Soundboard" Height="620" Width="900"
        AllowDrop="True"
        Drop="Window_Drop"
        DragOver="Window_DragOver">
  <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!-- Downloader -->
    <StackPanel>
      <StackPanel Orientation="Horizontal">
        <TextBox Width="460" Text="{Binding Url, UpdateSourceTrigger=PropertyChanged}" 
                 ToolTip="Enter YouTube URL"/>
        <ComboBox Width="100" Margin="8,0,0,0" SelectedItem="{Binding SelectedKind}">
          <ComboBoxItem Content="Audio"/>
          <ComboBoxItem Content="Video"/>
        </ComboBox>
        <Button Content="Download" Command="{Binding DownloadCommand}" Width="100" Margin="8,0,0,0"/>
        <Button Content="📁 Open Folder" Command="{Binding OpenFolderCommand}" Width="120" Margin="8,0,0,0" 
                ToolTip="Open downloads folder"/>
      </StackPanel>
      <StackPanel Orientation="Horizontal" Margin="0,6,0,12">
        <CheckBox Content="Auto-add audio to soundboard" 
                  IsChecked="{Binding AutoAddToSoundboard}"/>
        <CheckBox Content="Extract audio from videos" 
                  IsChecked="{Binding ExtractAudioFromVideos}" 
                  Margin="16,0,0,0"
                  ToolTip="Convert videos to MP3 using ffmpeg (allows adding to soundboard)"/>
      </StackPanel>
    </StackPanel>

    <!-- Soundboard controls -->
    <DockPanel Grid.Row="1">
      <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,8">
        <Button Content="Add Sound…" Command="{Binding AddSoundCommand}" Padding="12,4"/>
        <Button Content="Save Layout" Command="{Binding SaveLayoutCommand}" Margin="8,0,0,0" Padding="12,4"/>
        <TextBlock Text="{Binding Sounds.Count, StringFormat='Sounds: {0}'}" 
                   VerticalAlignment="Center" Margin="16,0,0,0" Opacity="0.7"/>
      </StackPanel>
      
      <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <ItemsControl ItemsSource="{Binding Sounds}">
          <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
              <WrapPanel Orientation="Horizontal"/>
            </ItemsPanelTemplate>
          </ItemsControl.ItemsPanel>
          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <Border Padding="10" Margin="4" BorderBrush="#ccc" BorderThickness="1" 
                      CornerRadius="6" Background="#f9f9f9" Width="180">
                <StackPanel>
                  <TextBlock Text="{Binding DisplayName}" FontWeight="Bold" 
                             TextTrimming="CharacterEllipsis" ToolTip="{Binding DisplayName}"/>
                  <TextBlock Text="{Binding HotkeyLabel}" Opacity="0.6" 
                             FontSize="11" Margin="0,2,0,8"/>
                  <StackPanel>
                    <Button Content="▶ Play" Command="{Binding PlayCommand}" 
                            Padding="8,4" FontWeight="SemiBold"/>
                    <Button Content="⌨ Bind Hotkey" Command="{Binding BindCommand}" 
                            Padding="8,4" Margin="0,4,0,0" FontSize="11"/>
                    <Button Content="✕ Remove" Command="{Binding RemoveCommand}" 
                            Padding="8,4" Margin="0,4,0,0" FontSize="11" 
                            Foreground="#c44"/>
                  </StackPanel>
                </StackPanel>
              </Border>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </ScrollViewer>
    </DockPanel>
  </Grid>
</Window>
